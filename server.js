!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.w={},n(n.s=35)}([function(e,t){e.exports=require("react")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(28),s=(o=l)&&o.__esModule?o:{default:o};var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.signUp=this.signUp.bind(this),this.fetch=this.fetch.bind(this)}return r(e,[{key:"signUp",value:function(e,t,n){var o=this;return this.fetch("/api/signup",{method:"POST",body:JSON.stringify({username:e,email:t,password:n})}).then(function(e){return e.token&&o.setToken(e.token),Promise.resolve(e)})}},{key:"logIn",value:function(e,t){var n=this;if(e&&t)return this.fetch("/api/login",{method:"POST",body:JSON.stringify({email:e,password:t})}).then(function(e){return e.token&&n.setToken(e.token),Promise.resolve(e)});alert("Please enter email and password")}},{key:"loggedIn",value:function(){return!!(this.getLocalToken()||this.getGoogleToken())}},{key:"logout",value:function(){localStorage.removeItem("local_token"),localStorage.removeItem("google_token")}},{key:"setToken",value:function(e){localStorage.setItem("local_token",e)}},{key:"getLocalToken",value:function(){return!!localStorage.getItem("local_token")&&localStorage.getItem("local_token")}},{key:"getGoogleToken",value:function(){return!!localStorage.getItem("google_token")&&localStorage.getItem("google_token")}},{key:"getProfile",value:function(){return!!this.getLocalToken()&&(0,s.default)(this.getLocalToken())}},{key:"getGoogleProfile",value:function(){return!!this.getGoogleToken()&&(0,s.default)(this.getGoogleToken())}},{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n={Accept:"application/json","Access-Control-Allow-Origin":"*","Content-Type":"application/json"};return this.loggedIn()&&(n.Authorization="Bearer "+this.getLocalToken()),fetch(e,a({headers:n},t)).then(this._checkStatus).then(function(e){return e.json()})})},{key:"_checkStatus",value:function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}}]),e}();t.default=i},function(e,t){e.exports=require("react-router-dom")},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("dotenv")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("passport")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),l=(o=r)&&o.__esModule?o:{default:o};var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),a(t,[{key:"render",value:function(){return l.default.createElement("div",{className:"ipad-instruction"},"VotePlex is a web-based application that enables you to create ranking, rating, and poll voting contests and view the results in real time. Your audience can participate live on their mobile phones, tablets and desktops. There is nothing to download or install.")}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),r=u(a),l=u(n(1)),s=n(2),i=u(n(8));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=n.handleChange.bind(n),n.Auth=new l.default,n.handleSubmit=n.handleSubmit.bind(n),n.state={username:null,email:null,password:null,passwordConfirm:null,error:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),o(t,[{key:"render",value:function(){var e=this.state.error?"error-message":"";return r.default.createElement("div",{className:"signUp d-flex flex-row justify-content-center"},r.default.createElement("div",{className:"row"},r.default.createElement("div",{className:"d-flex flex-row justify-content-center col-sm-6 ipad"},r.default.createElement(i.default,null)),r.default.createElement("div",{className:"d-flex flex-column col-sm-6 sign-up-form"},r.default.createElement("div",{className:"d-flex flex-column form-box"},r.default.createElement("h1",null,"VotePlex"),r.default.createElement("p",{className:e},this.state.error),r.default.createElement("div",null,r.default.createElement("form",{className:"d-flex flex-column",onSubmit:this.handleSubmit},r.default.createElement("p",null,"Sign up to vote"),r.default.createElement("a",{href:"/auth/google"},r.default.createElement("i",{className:"fa fa-google-plus","aria-hidden":"true"})," Log in with Google"),r.default.createElement("div",{className:"d-flex flex-row hr"},r.default.createElement("div",{className:"flex-grow-1 align-self-center line"}),r.default.createElement("div",{className:"p-2 letter"},"or"),r.default.createElement("div",{className:"flex-grow-1 align-self-center line"})),r.default.createElement("input",{className:"form-control",name:"username",placeholder:"Username",type:"text",onChange:this.handleChange}),r.default.createElement("input",{className:"form-control",name:"email",placeholder:"Email",type:"email",onChange:this.handleChange}),r.default.createElement("input",{className:"form-control",name:"password",placeholder:"password",type:"password",onChange:this.handleChange}),r.default.createElement("input",{className:"form-control",name:"passwordConfirm",placeholder:"Enter password again",type:"password",onChange:this.handleChange}),r.default.createElement("input",{type:"submit",value:"Sign Up",className:"btn btn-success",disabled:!this.state.username||!this.state.email||!this.state.password})))),r.default.createElement("div",{className:"go-to-login"},r.default.createElement("p",null,"Have an account ? ",r.default.createElement(s.Link,{to:"/login",className:"login-link"},"Log In"))))))}},{key:"handleChange",value:function(e){var t,n,o;this.setState((t={},n=e.target.name,o=e.target.value,n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.state.password===this.state.passwordConfirm?this.Auth.signUp(this.state.username,this.state.email,this.state.password).then(function(e){e.error?t.setState({error:e.error}):t.props.history.go("/")}):this.setState({error:"Please enter two same password!"})}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),l=(o=r)&&o.__esModule?o:{default:o};var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.drawChart=n.drawChart.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),a(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentDidMount",value:function(){var e=this;google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(function(){return e.drawChart()})}},{key:"drawChart",value:function(){var e=new google.visualization.DataTable;e.addColumn("string","Options"),e.addColumn("number","Votes");var t=[];this.props.options.map(function(e){t.push([e.name,e.votes])}),e.addRows(t);var n={title:this.props.pollName,titleTextStyle:{color:"#fff",fontName:"Tahoma",fontSize:20},width:800,height:500,animation:{startup:!0,duration:1e3,easing:"out"},backgroundColor:"#23252c",colors:["#f6b921"],dataOpacity:.8,legend:{position:"none"},hAxis:{textStyle:{color:"#e2e2e2",fontSize:12,fontName:"Tahoma"},maxTextLines:3}};new google.visualization.ColumnChart(this.refs.googleChart).draw(e,n)}},{key:"render",value:function(){return l.default.createElement("div",{className:"d-flex flex-row justify-content-center googleChart",ref:"googleChart"})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=l(n(5)),a=l(n(6)),r=l(n(7));function l(e){return e&&e.__esModule?e:{default:e}}l(n(4)).default.config({verbose:!0});var s=o.default.Router();s.get("/auth/google",a.default.authenticate("google",{scope:["profile"]})),s.get("/auth/google/redirect",a.default.authenticate("google",{session:!1}),function(e,t,n){var o=r.default.sign({_id:e.user._id,name:e.user.username,id:e.user.googleID,picture:e.user.picture},process.env.secret,{expiresIn:3600});t.redirect("/?googleToken="+o)}),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(3),r=(o=a)&&o.__esModule?o:{default:o};var l=new(0,r.default.Schema)({googleID:{type:String,unique:!0},username:{type:String},picture:{type:String}}),s=r.default.model("GoogleUser",l);t.default=s},function(e,t){e.exports=require("passport-google-oauth20")},function(e,t,n){"use strict";var o=l(n(6)),a=l(n(13)),r=(l(n(5)),l(n(12)));function l(e){return e&&e.__esModule?e:{default:e}}l(n(4)).default.config({verbose:!0}),o.default.use(new a.default({callbackURL:process.env.googleCallBackURL,clientID:process.env.googleClientID,clientSecret:process.env.googleClientSecret},function(e,t,n,o){r.default.findOne({googleID:n.id}).then(function(e){if(e)return o(null,e);new r.default({googleID:n.id,username:n.displayName,picture:n._json.image.url}).save().then(function(e){return o(null,e)})})}))},function(e,t){e.exports=require("body-parser")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(3),r=(o=a)&&o.__esModule?o:{default:o};var l=r.default.Schema,s=new l({name:{type:String,required:!0,unique:!0},votes:{type:Number,default:0}}),i=new l({user:{type:l.Types.ObjectId,ref:"GoogleUser"},name:{type:String,unique:!0,required:!0},options:[s]}),u=r.default.model("GooglePolls",i);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(3),r=(o=a)&&o.__esModule?o:{default:o};var l=r.default.Schema,s=new l({name:{type:String,required:!0,unique:!0},votes:{type:Number,default:0}}),i=new l({user:{type:l.Types.ObjectId,ref:"User"},name:{type:String,unique:!0,required:!0},options:[s]}),u=r.default.model("LocalPolls",i);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(3),r=(o=a)&&o.__esModule?o:{default:o};var l=new(0,r.default.Schema)({username:{type:String,required:!0,unique:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0}}),s=r.default.model("User",l);t.default=s},function(e,t){e.exports=require("bcrypt-nodejs")},function(e,t){e.exports=require("serialize-javascript")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),r=s(a),l=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=n.handleSubmit.bind(n),n.handleChange=n.handleChange.bind(n),n.Auth=new l.default,n.state={current:null,newPassWord:null,newConfirm:null,error:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),o(t,[{key:"componentDidMount",value:function(){var e=this;this.Auth.getGoogleToken()||this.Auth.getLocalToken()?this.Auth.getGoogleToken()&&this.setState({error:"You are using Google account, can not change password!"},function(){alert(e.state.error),e.props.history.replace("/")}):this.setState({error:"Have not logged in yet!"},function(){alert(e.state.error),e.props.history.replace("/login")})}},{key:"render",value:function(){var e=this.state.error?"error-message":"";return r.default.createElement("div",{className:"setting"},r.default.createElement("h1",null,"Change Password"),r.default.createElement("p",{className:e},this.state.error),r.default.createElement("form",{onSubmit:this.handleSubmit},r.default.createElement("input",{type:"password",name:"current",onChange:this.handleChange,className:"form-control",placeholder:"Current password"}),r.default.createElement("input",{type:"password",name:"newPassWord",onChange:this.handleChange,className:"form-control",placeholder:"New password"}),r.default.createElement("input",{type:"password",name:"newConfirm",onChange:this.handleChange,className:"form-control",placeholder:"Enter new password again"}),r.default.createElement("input",{type:"submit",value:"Save",className:"btn btn-success form-control",disabled:!this.state.current||!this.state.newPassWord||!this.state.newConfirm})))}},{key:"handleChange",value:function(e){var t,n,o;this.setState((t={},n=e.target.name,o=e.target.value,n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=this.Auth.getProfile().payload.email;this.state.newPassWord===this.state.newConfirm?fetch("/api/setting",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({email:n,current:this.state.current,newPassWord:this.state.newPassWord})}).then(function(e){return e.json()}).then(function(e){e.success?t.props.history.replace("/login"):t.setState({error:e.error})}):this.setState({error:"Please enter the same new password!"})}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),r=i(a),l=i(n(1)),s=i(n(10));function i(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={userId:null,pollName:null,options:[],submitted:!1,local:!1},n.Auth=new l.default,n.handleSubmit=n.handleSubmit.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),o(t,[{key:"componentDidMount",value:function(){var e=this,t=location.pathname.replace(/%20/g," ").split("/")[2],n=this.Auth.getProfile()?this.Auth.getProfile().payload._id:this.Auth.getGoogleProfile()._id,o=!!this.Auth.getProfile();fetch("/api/votes",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({userId:n,pollName:t,local:o})}).then(function(e){return e.json()}).then(function(t){e.setState({userId:n,pollName:t.name,options:t.options,submitted:!1,local:o})})}},{key:"eachOption",value:function(){var e=this;return this.state.options.map(function(t,n){return r.default.createElement("button",{key:n,className:"","data-selectedoption":t.name,onClick:e.handleSubmit},t.name)})}},{key:"render",value:function(){return this.state.submitted?r.default.createElement("div",{className:"display-google-chart"},r.default.createElement(s.default,{options:this.state.options,pollName:this.state.pollName})):r.default.createElement("div",{className:"vote"},r.default.createElement("h1",{className:"pollName"},this.state.pollName),r.default.createElement("div",{className:"d-flex flex-column align-items-center each-option"},this.eachOption()))}},{key:"handleSubmit",value:function(e){var t=this,n=e.currentTarget.dataset.selectedoption,o=this.state.userId,a=this.state.pollName,r=this.state.local;fetch("/api/updateVotes",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({userId:o,pollName:a,selectedOption:n,local:r})}).then(function(e){return e.json()}).then(function(e){t.setState({options:e.payload.options,submitted:!0})})}}]),t}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),r=u(a),l=u(n(1)),s=u(n(8)),i=n(2);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=n.handleSubmit.bind(n),n.handleChange=n.handleChange.bind(n),n.Auth=new l.default,n.state={email:null,password:null,error:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),o(t,[{key:"componentDidMount",value:function(){(this.Auth.getGoogleToken()||this.Auth.getLocalToken())&&this.props.history.replace("/")}},{key:"render",value:function(){var e=this.state.error?"error-message":"";return r.default.createElement("div",{className:"login d-flex flex-row justify-content-center"},r.default.createElement("div",{className:"row"},r.default.createElement("div",{className:"d-flex flex-row justify-content-center col-sm-6 ipad"},r.default.createElement(s.default,null)),r.default.createElement("div",{className:"d-flex flex-column col-sm-6 login-form"},r.default.createElement("div",{className:"d-flex flex-column form-box"},r.default.createElement("h1",null,"VotePlex"),r.default.createElement("p",{className:e},this.state.error),r.default.createElement("form",{className:"d-flex flex-column",onSubmit:this.handleSubmit},r.default.createElement("input",{className:"form-control",name:"email",placeholder:"Email",type:"email",onChange:this.handleChange,value:this.state.email}),r.default.createElement("input",{className:"form-control",name:"password",placeholder:"password",type:"password",onChange:this.handleChange,value:this.state.password}),r.default.createElement("input",{type:"submit",value:"Log In",className:"btn btn-success form-control",disabled:!this.state.email||!this.state.password}))),r.default.createElement("div",{className:"go-to-sign-up"},r.default.createElement("p",null,"Don't have an account ? ",r.default.createElement(i.Link,{to:"/",className:"sign-up-link"},"Sign up"))))))}},{key:"handleChange",value:function(e){var t,n,o;this.setState((t={},n=e.target.name,o=e.target.value,n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.Auth.logIn(this.state.email,this.state.password).then(function(e){e.error?t.setState({email:"",password:"",error:e.error}):t.props.history.replace("/")})}}]),t}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),r=s(a),l=s(n(10));function s(e){return e&&e.__esModule?e:{default:e}}var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleDelete=n.handleDelete.bind(n),n.handleShowPoll=n.handleShowPoll.bind(n),n.state={myPoll:[],showPoll:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),o(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.userId,n=this.props.local;fetch("/api/mypoll",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({userId:t,local:n})}).then(function(e){return e.json()}).then(function(t){e.setState({myPoll:t.myPoll})})}},{key:"eachPoll",value:function(){var e=this;return 0===this.state.myPoll.length?r.default.createElement("h1",null,'No polls yet! Click "+" to launch your own poll.'):this.state.myPoll.map(function(t){return r.default.createElement("div",{className:"d-flex flex-row justify-content-between each-poll"},r.default.createElement("h3",{className:"poll-name"},t.name),r.default.createElement("div",{className:"d-flex flex-row justify-content-between btns"},r.default.createElement("button",{className:"present",onClick:e.handleShowPoll,"data-showpoll":t.name},r.default.createElement("i",{className:"fa fa-caret-square-o-right"})," Present"),r.default.createElement("button",{className:"delete",onClick:e.handleDelete,"data-poll":t.name},r.default.createElement("i",{className:"fa fa-times-circle"})," Delete")))})}},{key:"render",value:function(){return this.state.showPoll&&!this.props.myPoll?r.default.createElement(l.default,{pollName:this.state.showPoll.name,options:this.state.showPoll.options}):r.default.createElement("div",{className:"dashboard"},r.default.createElement("h1",{className:"title"},"Dashboard"),r.default.createElement("div",{className:"polls"},this.eachPoll()))}},{key:"handleDelete",value:function(e){var t=this,n=e.currentTarget.dataset.poll,o=this.props.userId,a=this.props.local;fetch("/api/deleteMyPoll",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({userId:o,deletedPoll:n,local:a})}).then(function(e){return e.json()}).then(function(e){t.setState({myPoll:e.myPoll})})}},{key:"handleShowPoll",value:function(e){var t=e.currentTarget.dataset.showpoll;this.props.myPoll=!1;var n=this.state.myPoll.find(function(e){return e.name===t});this.setState({showPoll:n})}}]),t}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),l=(o=r)&&o.__esModule?o:{default:o};var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={pollName:"",options:["",""],submitted:!1,url:null,error:null},n.addOptions=n.addOptions.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n.handleChange=n.handleChange.bind(n),n.deleteOption=n.deleteOption.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),a(t,[{key:"addOptions",value:function(e){e.preventDefault();var t=this.state.options;t.push(""),this.setState({options:t})}},{key:"deleteOption",value:function(e){var t=e.currentTarget.dataset.option,n=this.state.options.slice(t);n.shift();var o=this.state.options.slice(0,t).concat(n);this.setState({options:o})}},{key:"eachOption",value:function(){var e=this;return this.state.options.map(function(t,n){return l.default.createElement("div",{className:"d-flex flex-row justify-content-between options"},l.default.createElement("input",{key:n,name:n,value:t,type:"text",className:"form-control",placeholder:"i.e. Enter your opition",onChange:e.handleChange}),l.default.createElement("span",{onClick:e.deleteOption,"data-option":n},"Ã—"))})}},{key:"render",value:function(){var e=this.state.options.length>2?"add-option":"",t=this.state.error?"error-message":"";return!this.props.newPoll&&this.state.submitted?l.default.createElement("div",{className:"poll-launched"},l.default.createElement("h1",null,"Congratulations!"),l.default.createElement("p",null,"Your poll has been posted to: ",l.default.createElement("a",{href:this.state.url,target:"_blank"}," ",this.state.url))):l.default.createElement("div",{className:"d-flex flex-column align-items-center create-new-poll"},l.default.createElement("form",{className:e,onSubmit:this.handleSubmit},l.default.createElement("p",{className:t},this.state.error),l.default.createElement("label",{for:"pollName"},"Name your poll"),l.default.createElement("input",{name:"pollName",type:"text",className:"form-control",placeholder:"i.e. What is your favorite color",onChange:this.handleChange}),l.default.createElement("label",null,"Options"),this.eachOption(),l.default.createElement("a",{href:"#",onClick:this.addOptions},l.default.createElement("i",{className:"fa fa-plus"})," Add option"),l.default.createElement("input",{type:"submit",value:"Lauch Poll",className:"btn btn-success form-control",disabled:!this.state.pollName||this.state.options.includes("")})))}},{key:"handleChange",value:function(e){if("pollName"===e.target.name)this.setState({pollName:e.target.value});else{var t=this.state.options;t[e.target.name]=e.target.value,this.setState({options:t})}}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),fetch("api/submitPoll",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({userId:this.props.userId,local:this.props.local,pollName:this.state.pollName,options:this.state.options})}).then(function(e){return e.json()}).then(function(e){e.success?(t.props.newPoll=!1,t.setState({submitted:!0,url:"/"+t.props.username+"/"+e.payload.name,options:["",""]})):t.setState({error:e.error})})}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),r=u(a),l=u(n(25)),s=u(n(24)),i=(n(2),u(n(1)));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={newPoll:!1,showSidebar:!0,selectedNavTag:"dashboard"},n.clickMyPolls=n.clickMyPolls.bind(n),n.clickNewPoll=n.clickNewPoll.bind(n),n.printOutPolls=n.printOutPolls.bind(n),n.handleLogout=n.handleLogout.bind(n),n.toggleMenu=n.toggleMenu.bind(n),n.isActive=n.isActive.bind(n),n.Auth=new i.default,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),o(t,[{key:"render",value:function(){var e=this.props.local?this.props.user.payload.username:this.props.user.name,t=this.state.showSidebar?"":"hide-sidebar",n=this.props.user.picture||"https://cdn2.iconfinder.com/data/icons/business-charts/512/account-512.png";return r.default.createElement("div",{className:"profile "+t},r.default.createElement("div",{className:"d-flex flex-row justify-content-between sidebar-header"},r.default.createElement("h3",{className:"brand"},"VotePlex"),r.default.createElement("div",{className:"btn-sidebar",onClick:this.toggleMenu},r.default.createElement("a",null),r.default.createElement("a",null),r.default.createElement("a",null))),r.default.createElement("div",{className:"sidebar-wrapper"},r.default.createElement("div",{className:"d-flex flex-row  userInfo"},r.default.createElement("img",{src:n,height:"30",width:"30",style:{borderRadius:"50%"}}),r.default.createElement("p",null,e)),r.default.createElement("ul",{className:"side-nav"},r.default.createElement("li",{className:this.isActive("dashboard")?"active":""},r.default.createElement("a",{"data-selectednavtag":"dashboard",onClick:this.clickMyPolls},r.default.createElement("i",{className:"fa fa-dashboard"}),"Dashbord")),r.default.createElement("li",{className:this.isActive("creat")?"active":""},r.default.createElement("a",{"data-selectednavtag":"creat",onClick:this.clickNewPoll},r.default.createElement("i",{className:"fa fa-plus"})," Create")),r.default.createElement("li",null,r.default.createElement("a",{href:"/setting"},r.default.createElement("i",{className:"fa fa-cog"})," Setting")),r.default.createElement("li",null,r.default.createElement("a",{href:"/login",onClick:this.handleLogout},r.default.createElement("i",{className:"fa fa-sign-out"})," Log Out")))),r.default.createElement("div",{className:"page-content"},this.printOutPolls()))}},{key:"handleLogout",value:function(){this.Auth.logout()}},{key:"printOutPolls",value:function(){var e=this.props.local?this.props.user.payload._id:this.props.user._id,t=this.props.local?this.props.user.payload.username:this.props.user.name;return this.state.newPoll?r.default.createElement(l.default,{userId:e,username:t,newPoll:this.state.newPoll,local:this.props.local}):r.default.createElement(s.default,{userId:e,myPoll:!this.state.newPoll,local:this.props.local})}},{key:"isActive",value:function(e){return e===this.state.selectedNavTag}},{key:"clickMyPolls",value:function(e){e.preventDefault();var t=e.currentTarget.dataset.selectednavtag;this.setState({newPoll:!1,selectedNavTag:t})}},{key:"clickNewPoll",value:function(e){e.preventDefault();var t=e.currentTarget.dataset.selectednavtag;this.setState({newPoll:!0,selectedNavTag:t})}},{key:"toggleMenu",value:function(){this.setState({showSidebar:!this.state.showSidebar})}}]),t}();t.default=c},function(e,t){e.exports=require("query-string")},function(e,t){e.exports=require("jwt-decode")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),r=c(a),l=c(n(1)),s=c(n(27)),i=(n(2),c(n(26))),u=c(n(9));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.Auth=new l.default,n.state={user:null,local:!0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),o(t,[{key:"componentDidMount",value:function(){var e=this,t=this.Auth.getLocalToken(),n=s.default.parse(location.search).googleToken||this.Auth.getGoogleToken();if(n){localStorage.setItem("google_token",n);var o=this.Auth.getGoogleProfile();this.setState({user:o,local:!1},function(){e.props.history.replace("/")})}else if(t){var a=this.Auth.getProfile();this.setState({user:a,local:!0})}else this.setState({user:null,local:!0})}},{key:"render",value:function(){return this.state.user?r.default.createElement(i.default,{user:this.state.user,local:this.state.local}):r.default.createElement(u.default,{history:this.props.history})}}]),t}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s(n(29)),a=(s(n(9)),s(n(23))),r=s(n(22)),l=s(n(21));function s(e){return e&&e.__esModule?e:{default:e}}var i=[{path:"/",exact:!0,component:o.default},{path:"/login",exact:!0,component:a.default},{path:"/:username/:pollname",exact:!0,component:r.default},{path:"/setting",exact:!0,component:l.default}];t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),l=u(r),s=u(n(30)),i=n(2);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),a(t,[{key:"render",value:function(){return l.default.createElement("div",{className:"app"},l.default.createElement(i.Switch,null,s.default.map(function(e){var t=e.path,n=e.exact,a=e.component,r=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["path","exact","component"]);return l.default.createElement(i.Route,{key:t,path:t,exact:n,render:function(e){return l.default.createElement(a,o({},e,r))}})})))}}]),t}();t.default=c},function(e,t){e.exports=require("react-dom/server")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=h(n(0)),a=n(2),r=n(32),l=h(n(5)),s=h(n(31)),i=h(n(20)),u=h(n(19)),c=h(n(7)),f=h(n(18)),d=h(n(17)),p=h(n(16));function h(e){return e&&e.__esModule?e:{default:e}}h(n(4)).default.config({verbose:!0});var m=l.default.Router({caseSensitive:!0});m.get("*",function(e,t,n){var l=(0,r.renderToString)(o.default.createElement(a.StaticRouter,{location:e.url,context:{}},o.default.createElement(s.default,null)));t.send('\n        <!DOCTYPE html>\n        <html>\n            <head>\n                <title>Voting Plex</title>\n                <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">\n                <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet">\n                <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">\n                <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"><\/script>\n                <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"><\/script>\n                <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"><\/script>\n                <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js" defer><\/script>\n                <script src="https://use.fontawesome.com/b2bddaf3ba.js"><\/script>\n                <script type="text/javascript" src=\'/bundle.js\' defer><\/script>\n                <script>window.__INITIAL_DATA__='+(0,i.default)("Tyler")+"<\/script>\n            </head>\n        <body>\n            <div id='app' class='container-fluid'>"+l+"</div>\n        </body>\n        </html>\n    ")}),m.post("/api/signup",function(e,t,n){var o=e.body,a=o.username,r=o.email,l=o.password,s={username:a,email:r,password:u.default.hashSync(l,u.default.genSaltSync(10))};f.default.create(s).then(function(e){var n=c.default.sign({payload:e},process.env.secret,{expiresIn:3600});t.json({success:!0,error:null,token:n})},function(e){"BulkWriteError"===e.name&&11e3===e.code&&t.json({success:!1,error:"User already exist!",token:null})})}),m.post("/api/login",function(e,t,n){var o=e.body,a=o.email,r=o.password;f.default.findOne({email:a}).then(function(e){if(null===e)t.json({success:!1,error:"Email or password incorrect!",token:null});else if(e.email===a&&u.default.compareSync(r,e.password)){var n=c.default.sign({payload:e},process.env.secret,{expiresIn:36e3});t.json({success:!0,error:null,token:n})}else t.json({success:!1,error:"Email or password incorrect!",token:null})},function(e){t.json({success:!1,error:e,token:null})})}),m.post("/api/setting",function(e,t,n){var o=e.body,a=o.email,r=o.current,l=o.newPassWord;f.default.findOne({email:a}).then(function(e){u.default.compareSync(r,e.password)?f.default.updateOne({email:a},{password:u.default.hashSync(l,u.default.genSaltSync(10))}).then(function(){t.json({success:!0,error:null,payload:e})}):t.json({success:!1,error:"Incorrect Current Password!"})})}),m.post("/api/submitPoll",function(e,t,n){var o=e.body,a=o.userId,r=o.pollName,l=o.options,s=o.local,i=[];l.map(function(e){i.push({name:e,votes:0})});var u=s?d.default:p.default,c={user:a,name:r,options:i};u.create(c).then(function(e){t.json({success:!0,payload:e})},function(e){"BulkWriteError"===e.name&&11e3===e.code&&t.json({success:!1,error:"Poll already exist!"})})}),m.post("/api/votes",function(e,t,n){var o=e.body,a=o.userId,r=o.pollName,l=o.local;r&&(l?d.default:p.default).findOne({user:a,name:r}).then(function(e){t.json(e)})}),m.post("/api/updateVotes",function(e,t,n){var o=e.body,a=o.userId,r=o.pollName,l=o.selectedOption,s=o.local;if(a){var i=s?d.default:p.default;i.updateOne({user:a,name:r,"options.name":l},{$inc:{"options.$.votes":1}}).then(function(){i.findOne({user:a,name:r}).then(function(e){t.json({payload:e})})})}}),m.post("/api/mypoll",function(e,t,n){var o=e.body,a=o.userId,r=o.local;a&&(r?d.default:p.default).find({user:a}).then(function(e){t.json({myPoll:e})})}),m.post("/api/deleteMyPoll",function(e,t,n){var o=e.body,a=o.userId,r=o.deletedPoll,l=o.local;if(a){var s=l?d.default:p.default;s.remove({user:a,name:r}).then(function(){s.find({user:a}).then(function(e){t.json({myPoll:e})})})}}),t.default=m},function(e,t){e.exports=require("cors")},function(e,t,n){"use strict";var o=c(n(5)),a=(c(n(34)),c(n(3))),r=c(n(4)),l=c(n(33)),s=c(n(15)),i=c(n(6)),u=(c(n(14)),c(n(11)));function c(e){return e&&e.__esModule?e:{default:e}}r.default.config({verbose:!0});var f=process.env.MONGODB_URI||process.env.localDB,d=process.env.PORT||4e3,p=(0,o.default)();p.use(s.default.json()),p.use(i.default.initialize()),p.use(o.default.static("public")),p.use(u.default),p.use(l.default),a.default.connect(f,function(e){e&&console.log(e)}),a.default.connection.on("connected",function(){console.log("Successfully opened a connection to "+f)}),a.default.connection.on("disconnected",function(){console.log("Disconnected from "+f)}),a.default.connection.on("error",function(){console.log("An error has occured connecting to "+f)}),p.listen(d,function(){console.log("Server is listening requests on "+d)})}]);